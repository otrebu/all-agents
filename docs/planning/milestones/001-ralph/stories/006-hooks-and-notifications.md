## Story: Hooks & Notifications

### Narrative
As a developer running long autonomous builds, I want to be notified of key events and have checkpoints so that I can stay informed without watching the terminal.

### Persona
A developer who starts a Ralph build and walks away. They want push notifications on completion or failure. They want the system to pause at important moments (like after calibration creates tasks) so they can decide what to do.

### Context
Hooks enable human-on-the-loop checkpoints. Events trigger actions like logging, notifications, or pausing. The iteration diary captures what happened in each session for later analysis.

### Acceptance Criteria
- [ ] Hooks configurable in `ralph.config.json`:
  - `onIterationComplete` - after each subtask attempt
  - `onMilestoneComplete` - when all subtasks done
  - `onValidationFail` - when build/lint/test fails
  - `onMaxIterationsExceeded` - when iteration limit hit
- [ ] Actions available: `log`, `notify`, `pause`
- [ ] Push notifications via ntfy (default provider)
- [ ] Iteration diary at `logs/iterations.jsonl` with:
  - subtaskId, sessionId, status, summary, timestamp, errors
  - toolCalls count, filesChanged, duration
- [ ] Summary generated by haiku from session JSONL
- [ ] Pause shows what triggered it and gives options to continue
- [ ] Status field uses enum: completed, failed, or retrying
- [ ] ralph.config.json template created with default hook settings

### Tasks
- [ ] [TASK-018: Create iteration-summary.md prompt (hook)](../tasks/018-Create%20iteration-summary.md%20prompt%20(hook).md)
- [ ] [TASK-019: Implement post-iteration-hook.sh](../tasks/019-Implement%20post-iteration-hook.sh.md)
- [ ] [TASK-020: Create iteration-diary.schema.json](../tasks/020-Create%20iteration-diary.schema.json.md)
- [ ] [TASK-024: Create ralph.config.json template](../tasks/024-Create%20ralph.config.json%20template.md)

### Notes
- ntfy.sh for notifications (simple HTTP POST)
- iteration-summary.md uses `{{VAR}}` placeholders (bash substitution, not @path)
- Diary schema at: `docs/planning/schemas/iteration-diary.schema.json`
- Template: docs/planning/templates/iteration-diary.template.json
- Reference: VISION.md sections 5 (Hooks & Notifications) and 8.11
