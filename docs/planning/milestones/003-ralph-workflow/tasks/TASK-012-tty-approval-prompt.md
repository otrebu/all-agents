## Task: TTY Approval Prompting

**Story:** [STORY-001-artifact-approvals](../stories/STORY-001-artifact-approvals.md)

**Depends on:** [TASK-010-approval-evaluation](./TASK-010-approval-evaluation.md)

### Goal

Implement Y/n prompt function for the `"prompt"` action, enabling interactive approval in TTY mode.

### Context

When `evaluateApproval()` returns `"prompt"` (TTY + `"always"` mode), the cascade needs to show what's being created and wait for explicit user approval. This follows the existing pattern from `promptContinue()` in cascade.ts but is specific to artifact approval.

The prompt function receives a summary of what will be created (generated by the caller) and returns whether the user approved or rejected.

### Plan

1. Add `formatGateName()` helper function in `tools/src/commands/ralph/approvals.ts`:
   ```typescript
   /**
    * Format gate name for display
    * createStories → "Create Stories"
    * onDriftDetected → "Drift Detected"
    */
   function formatGateName(gate: ApprovalGate): string {
     return gate
       .replace(/^create/, "Create ")
       .replace(/^on/, "")
       .replace(/([A-Z])/g, " $1")
       .replace(/^\s+/, "")
       .trim();
   }
   ```

2. Add `promptApproval()` function in `tools/src/commands/ralph/approvals.ts`:
   ```typescript
   import * as readline from "node:readline";

   /**
    * Prompt user to approve an artifact creation in TTY mode
    *
    * Shows artifact summary and waits for Y/n response.
    * Default is Yes (empty input or 'y' approves).
    * Only 'n' or 'no' rejects.
    *
    * @param gate - Which approval gate triggered this prompt
    * @param summary - Description of what will be created (can be multi-line)
    * @returns true if approved, false if rejected
    *
    * @example
    * const approved = await promptApproval("createStories",
    *   "Creating 3 stories:\n  - STORY-001-auth.md\n  - STORY-002-api.md"
    * );
    * if (!approved) {
    *   console.log("Aborted by user");
    *   return;
    * }
    */
   async function promptApproval(
     gate: ApprovalGate,
     summary: string
   ): Promise<boolean> {
     // Format gate name for display
     const gateDisplay = formatGateName(gate);

     // Show what's being created
     console.log();
     console.log(`${gateDisplay}:`);
     console.log(summary);
     console.log();

     // Prompt using readline
     return new Promise<boolean>((resolve) => {
       const rl = readline.createInterface({
         input: process.stdin,
         output: process.stdout,
       });

       rl.question("Approve? [Y/n]: ", (answer) => {
         rl.close();
         const normalized = answer.trim().toLowerCase();
         // Default to yes (empty input), explicit 'n' or 'no' to reject
         if (normalized === "n" || normalized === "no") {
           resolve(false);
         } else {
           resolve(true);
         }
       });
     });
   }
   ```

3. Export `promptApproval` and `formatGateName` from `approvals.ts`:
   ```typescript
   export {
     type ApprovalAction,
     type ApprovalContext,
     evaluateApproval,
     formatGateName,
     promptApproval,
   };
   ```

### Acceptance Criteria

- [ ] `promptApproval()` function exported from `approvals.ts`
- [ ] `formatGateName()` helper exported from `approvals.ts`
- [ ] Gate names formatted correctly:
  - `createStories` → "Create Stories"
  - `createSubtasks` → "Create Subtasks"
  - `onDriftDetected` → "Drift Detected"
  - `correctionTasks` → "Correction Tasks"
- [ ] Summary displayed before prompt
- [ ] Prompt shows `Approve? [Y/n]: `
- [ ] Empty input (just Enter) returns `true`
- [ ] `y`, `Y`, `yes`, `YES` returns `true`
- [ ] `n`, `N`, `no`, `NO` returns `false`
- [ ] Any other input returns `true` (default yes)
- [ ] Function is async, returns `Promise<boolean>`

### Test Plan

- [ ] Manual: TTY prompt displays gate name and summary
- [ ] Manual: Press Enter (empty) → approved (returns true)
- [ ] Manual: Type 'y' + Enter → approved
- [ ] Manual: Type 'n' + Enter → rejected (returns false)
- [ ] Manual: Type 'no' + Enter → rejected
- [ ] Manual: Type 'yes' + Enter → approved
- [ ] Manual: Type 'abc' + Enter → approved (default yes)
- [ ] TypeScript compiles without errors (`bun run typecheck`)

### Scope

- **In:** `promptApproval()` function, `formatGateName()` helper, readline handling, exports
- **Out:** Summary generation (caller's responsibility), non-TTY handling, cascade integration

### Notes

**Gate name formatting examples:**

| Gate | Display |
|------|---------|
| `createRoadmap` | "Create Roadmap" |
| `createStories` | "Create Stories" |
| `createTasks` | "Create Tasks" |
| `createSubtasks` | "Create Subtasks" |
| `createAtomicDocs` | "Create Atomic Docs" |
| `onDriftDetected` | "Drift Detected" |
| `correctionTasks` | "Correction Tasks" |
| `promptChanges` | "Prompt Changes" |

**Caller responsibility:**
The cascade integration (separate task) is responsible for:
1. Generating the summary string (list of files, counts, etc.)
2. Calling `promptApproval()` when action is `"prompt"`
3. Handling the boolean result (proceed or abort)

**Non-TTY safety:**
If called when stdin is not TTY, readline will hang waiting for input. The caller should never call this function when `!process.stdin.isTTY` - the evaluation logic ensures `"prompt"` is only returned for TTY mode.

**Pattern consistency:**
This follows the same pattern as existing `promptContinue()` in cascade.ts:
- Uses readline.createInterface
- Default yes behavior
- Explicit 'n'/'no' to reject
- Closes readline after response
